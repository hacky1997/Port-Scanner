import socket
from datetime import datetime


remoteServer = input("Enter a remote host to scan: ")
remoteServerIP = socket.gethostbyname(remoteServer)

print ("-" * 40)
print ("           PORT SCANNER")
print ("      created by: 4n0n_5y4y4k")
print ("-" * 40)

print ("IP is: "+remoteServerIP)
print ("please wait while scanning: ")
t1 = datetime.now()

common_ports = {'1' : "tcpmux (TCP Port Service Multiplexer)",'2' : "Management Utility",'3' : "Compression Process",'5' : "rje (Remote Job Entry)",'7' : "echo",'9' : "discard",'11' : "systat",'13' : "daytime",'15' : "netstat",'17' : "quote of the day",'18' : "send/rwp",'19' : "character generator",'20' : "ftp-data",'21' : "ftp",'22' : "ssh, pcAnywhere",'23' : "Telnet",'25' : "SMTP (Simple Mail Transfer)",'27' : "ETRN (NSW User System FE)",'29' : "MSG ICP",'31' : "MSG Authentication",'33' : "dsp (Display Support Protocol)",'37' : "time",'38' : "RAP (Route Access Protocol)",'39' : "rlp (Resource Location Protocol)",'41' : "Graphics",'42' : "nameserv, WINS",'43' : "whois, nickname",'44' : "MPM FLAGS Protocol",'45' : "Message Processing Module [recv",'46' : "MPM [default send",'47' : "NI FTP",'48' : "Digital Audit Daemon",'49' : "TACACS, Login Host Protocol",'50' : "RMCP, re-mail-ck",'53' : "DNS",'57' : "MTP (any private terminal access)",'59' : "NFILE",'60' : "Unassigned",'61' : "NI MAIL",'62' : "ACA Services",'63' : "whois++",'64' : "Communications Integrator (CI)",'65' : "TACACS-Database Service",'66' : "Oracle SQL*NET",'67' : "bootps (Bootstrap Protocol Server)",'68' : "bootpd/dhcp (Bootstrap Protocol Client)",'69' : "Trivial File Transfer Protocol (tftp)",'70' : "Gopher",'71' : "Remote Job Service",'72' : "Remote Job Service",'73' : "Remote Job Service",'74' : "Remote Job Service",'75' : "any private dial out service",'76' : "Distributed External Object Store",'77' : "any private RJE service",'78' : "vettcp",'79' : "finger",'80' : "World Wide Web HTTP",'81' : "HOSTS2 Name Serve",'82' : "XFER Utility",'83' : "MIT ML Device",'84' : "Common Trace Facility",'85' : "MIT ML Device",'86' : "Micro Focus Cobol",'87' : "any private terminal link",'88' : "Kerberos, WWW",'89' : "SU/MIT Telnet Gateway",'90' : "DNSIX Securit Attribute Token Map",'91' : "MIT Dover Spooler",'92' : "Network Printing Protocol",'93' : "Device Control Protocol",'94' : "Tivoli Object Dispatcher",'95' : "supdup",'96' : "DIXIE",'98' : "linuxconf",'99' : "Metagram Relay",'100' : "[unauthorized use",'101' : "HOSTNAME",'102' : "ISO, X.400, ITOT",'103' : "Genesis Point-to-Point",'104' : "ACR-NEMA Digital Imag. & Comm. 300",'105' : "CCSO name server protocol",'106' : "poppassd",'107' : "Remote Telnet Service",'108' : "SNA Gateway Access Server",'109' : "POP2",'110' : "POP3",'111' : "Sun RPC Portmapper",'112' : "McIDAS Data Transmission Protocol",'113' : "Authentication Service",'115' : "sftp (Simple File Transfer Protocol)",'116' : "ANSA REX Notify",'117' : "UUCP Path Service",'118' : "SQL Services",'119' : "NNTP",'120' : "CFDP",'123' : "NTP",'124' : "SecureID",'129' : "PWDGEN",'133' : "statsrv",'135' : "loc-srv/epmap",'137' : "netbios-ns",'138' : "netbios-dgm (UDP)",'139' : "NetBIOS",'143' : "IMAP",'144' : "NewS",'150' : "SQL-NET",'152' : "BFTP",'153' : "SGMP",'156' : "SQL Service",'161' : "SNMP",'175' : "vmnet",'177' : "XDMCP",'178' : "NextStep Window Server",'179' : "BGP",'180' : "SLmail admin",'199' : "smux",'210' : "Z39.50",'213' : "IPX",'218' : "MPP",'220' : "IMAP3",'256' : "RAP",'257' : "Secure Electronic Transaction",'258' : "Yak Winsock Personal Chat",'259' : "ESRO",'264' : "FW1_topo",'311' : "Apple WebAdmin",'350' : "MATIP type A",'351' : "MATIP type B",'363' : "RSVP tunnel",'366' : "ODMR (On-Demand Mail Relay)",'371' : "Clearcase",'387' : "AURP (AppleTalk Update-Based Routing Protocol)",'389' : "LDAP",'407' : "Timbuktu",'427' : "Server Location",'434' : "Mobile IP",'443' : "ssl",'444' : "snpp, Simple Network Paging Protocol",'445' : "SMB",'458' : "QuickTime TV/Conferencing",'468' : "Photuris",'475' : "tcpnethaspsrv",'500' : "ISAKMP, pluto",'511' : "mynet-as",'512' : "biff, rexec",'513' : "who, rlogin",'514' : "syslog, rsh",'515' : "lp, lpr, line printer",'517' : "talk",'520' : "RIP (Routing Information Protocol)",'521' : "RIPng",'522' : "ULS",'531' : "IRC",'543' : "KLogin, AppleShare over IP",'545' : "QuickTime",'548' : "AFP",'554' : "Real Time Streaming Protocol",'555' : "phAse Zero",'563' : "NNTP over SSL",'575' : "VEMMI",'581' : "Bundle Discovery Protocol",'593' : "MS-RPC",'608' : "SIFT/UFT",'626' : "Apple ASIA",'631' : "IPP (Internet Printing Protocol)",'635' : "RLZ DBase",'636' : "sldap",'642' : "EMSD",'648' : "RRP (NSI Registry Registrar Protocol)",'655' : "tinc",'660' : "Apple MacOS Server Admin",'666' : "Doom",'674' : "ACAP",'687' : "AppleShare IP Registry",'700' : "buddyphone",'705' : "AgentX for SNMP",'901' : "swat, realsecure",'993' : "s-imap",'995' : "s-pop",'1024' : "Reserved",'1025' : "network blackjack",'1062' : "Veracity",'1080' : "SOCKS",'1085' : "WebObjects",'1227' : "DNS2Go",'1243' : "SubSeven",'1248' : 'hermes','1338' : "Millennium Worm",'1352' : "Lotus Notes",'1381' : "Apple Network License Manager",'1417' : "Timbuktu Service 1 Port",'1418' : "Timbuktu Service 2 Port",'1419' : "Timbuktu Service 3 Port",'1420' : "Timbuktu Service 4 Port",'1433' : "Microsoft SQL Server",'1434' : "Microsoft SQL Monitor",'1477' : "ms-sna-server",'1478' : "ms-sna-base",'1490' : "insitu-conf",'1494' : "Citrix ICA Protocol",'1498' : "Watcom-SQL",'1500' : "VLSI License Manager",'1503' : "T.120",'1521' : "Oracle SQL",'1522' : "Ricardo North America License Manager",'1524' : "ingres",'1525' : "prospero",'1526' : "prospero",'1527' : "tlisrv",'1529' : "oracle",'1547' : "laplink",'1604' : "Citrix ICA, MS Terminal Server",'1645' : "RADIUS Authentication",'1646' : "RADIUS Accounting",'1680' : "Carbon Copy",'1701' : "L2TP/LSF",'1717' : "Convoy",'1720' : "H.323/Q.931",'1723' : "PPTP control port",'1731' : "MSICCP",'1755' : "Windows Media .asf",'1758' : "TFTP multicast",'1761' : "cft-0",'1762' : "cft-1",'1763' : "cft-2",'1764' : "cft-3",'1765' : "cft-4",'1766' : "cft-5",'1767' : "cft-6",'1808' : "Oracle-VP2",'1812' : "RADIUS server",'1813' : "RADIUS accounting",'1818' : "ETFTP",'1973' : "DLSw DCAP/DRAP",'1985' : "HSRP",'1999' : "Cisco AUTH",'2001' : "glimpse",'2049' : "NFS",'2064' : "distributed.net",'2065' : "DLSw",'2066' : "DLSw",'2106' : "MZAP",'2140' : "DeepThroat",'2301' : "Compaq Insight Management Web Agents",'2327' : "Netscape Conference",'2336' : "Apple UG Control",'2427' : "MGCP gateway",'2504' : "WLBS",'2535' : "MADCAP",'2543' : "sip",'2592' : "netrek",'2727' : "MGCP call agent",'2628' : "DICT",'2998' : "ISS Real Secure Console Service Port",'3000' : "Firstclass",'3001' : "Redwood Broker",'3031' : "Apple AgentVU",'3128' : "squid",'3130' : "ICP",'3150' : "DeepThroat",'3264' : "ccmail",'3283' : "Apple NetAssitant",'3288' : "COPS",'3305' : "ODETTE",'3306' : "mySQL",'3389' : "RDP Protocol (Terminal Server)",'3521' : "netrek",'4000' : "icq, command-n-conquer and shell nfm",'4321' : "rwhois",'4333' : "mSQL",'4444' : "KRB524",'4827' : "HTCP",'5002' : "radio free ethernet",'5004' : "RTP",'5005' : "RTP",'5010' : "Yahoo! Messenger",'5050' : "multimedia conference control tool",'5060' : "SIP",'5150' : "Ascend Tunnel Management Protocol",'5190' : "AIM",'5500' : "securid",'5501' : "securidprop",'5423' : "Apple VirtualUser",'5555' : "Personal Agent",'5631' : "PCAnywhere data",'5632' : "PCAnywhere",'5678' : "Remote Replication Agent Connection",'5800' : "VNC",'5801' : "VNC",'5900' : "VNC",'5901' : "VNC",'6000' : "X Windows",'6112' : "BattleNet",'6502' : "Netscape Conference",'6667' : "IRC",'6670' : "VocalTec Internet Phone, DeepThroat",'6699' : "napster",'6776' : "Sub7",'6970' : "RTP",'7007' : "MSBD, Windows Media encoder",'7070' : "RealServer/QuickTime",'7777' : "cbt",'7778' : "Unreal",'7648' : "CU-SeeMe",'7649' : "CU-SeeMe",'8000' : "iRDMI/Shoutcast Server",'8010' : "WinGate 2.1",'8080' : "HTTP",'8181' : "HTTP",'8383' : "IMail WWW",'8875' : "napster",'8888' : "napster",'8889' : "Desktop Data TCP 1",'8890' : "Desktop Data TCP 2",'8891' : "Desktop Data TCP 3: NESS application",'8892' : "Desktop Data TCP 4: FARM product",'8893' : "Desktop Data TCP 5: NewsEDGE/Web application",'8894' : "Desktop Data TCP 6: COAL application",'9000' : "CSlistener",'10008' : "cheese worm",'11371' : "PGP 5 Keyserver",'13223' : "PowWow",'13224' : "PowWow",'14237' : "Palm",'14238' : "Palm",'18888' : "LiquidAudio",'21157' : "Activision",'22555' : "Vocaltec Web Conference",'23213' : "PowWow",'23214' : "PowWow",'23456' : "EvilFTP",'26000' : "Quake",'27001' : "QuakeWorld",'27010' : "Half-Life",'27015' : "Half-Life",'27960' : "QuakeIII",'30029' : "AOL Admin",'31337' : "Back Orifice",'32777' : "rpc.walld",'45000' : "Cisco NetRanger postofficed",'32773' : "rpc bserverd",'32776' : "rpc.spray",'32779' : "rpc.cmsd",'38036' : "timestep",'40193' : "Novell",'41524' : "arcserve discovery"}

try:
    for port in range(1,65535):
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(1)
        result = s.connect_ex((remoteServer,port))
        #ip=remoteServerIP
        #s.connect(ip,port)
        if result==0: 
           print ("[*] open port: ",format(port)+" /", common_ports[format(port)])
        # elif result==1:
        #    print ("[!] close port: ",format(port)+" /", common_ports[format(port)])   
        s.close()
except:
    pass

t2= datetime.now()
total =  t2 - t1
print ('Scanning Completed in: ', total)
